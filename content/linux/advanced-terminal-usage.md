---
title: Linux. Продвинутое использование терминала
date: 2021-09-15
tag: linux
draft: true
---

Прежде чем ты начнёшь постигать Linux кунг-фу при использовании конкретных программ, стоит отточить базовые навыки использования терминала, чтобы поднять скорость взаимодействия с терминалом на новый уровень.

Я напишу про слежующие техники:

* Редактирование команд
* Перемещение по истории команд

# Редактирование команд

При работе с терминалом часто приходится редактировать уже написанные команды.

Чтобы изменить какое-то слово в команде, все новички зажимают стрелку вправо/влево, и ждут пока курсор до туда доползёт, чтобы потом зажать `Delete` или `Backspace` для удаления слова:

{{< gif "common editing" "/assets/gifs/linux-common-editing.gif" >}}

Так вот, забудь про зажимание стрелок на клавиатуре -- каждый раз, когда ты это делаешь, у тебя отнимается 10 очков стиля.

Вместо стрелок, `Delete` и `Backspace`, используй следующие горячие клавиши:

* `Alt+F` -- сдвинуться на слово вперёд (F - forward)
* `Alt+B` -- сдвинуться на слово назад (B - backward)
* `Ctrl+A` -- переместиться в начало строки (я запомнил как "**A**АААА...)
* `Ctrl+E` -- переместиться в конец строки ("...**Е**ЕЕЕЕ РОККК!")
* `Ctrl+W` -- удалить предыдущее слово

Вот тебе, для сравнения, то же самое редактирование команды, что и выше, но с помощью `Alt+B`, `Alt+B`, `Ctrl+W`, `Ctrl+W`:

{{< gif "pro editing" "/assets/gifs/linux-pro-editing.gif" >}}

Попробуй сам поиграться со всеми указанными горячими клавишами с этой же командой:

```
echo 'this is example of some command'
```

Эти горячие клавиши не сразу впитаются в подкорку, и ты всё ещё будешь тянуться к стрелкам -- просто старайся с этого дня использовать их как можно чаще.

# Перемещение по истории

Иногда тебе надо ещё раз исполнить команду, которую ты исполнял до этого -- для этого в терминале существует история команд.

Для работы с историей команд тебе надо знать 3 основных комбинации:

* `Ctrl+P` -- предыдущая команда
* `Ctrl+N` -- следующая команда
* `Ctrl+R` -- поиск в истории команд. После нажатия этой комбинации ты можешь ввести любой текст, и терминал попробует найти наиболее подходящую команду в истории

Скопируй и вставь эти команды:

```
echo 'Linux'
echo 'is'
echo 'really'
echo 'cool'
```

* Попробуй дойти до `echo 'Linux'` с помощью `Ctrl+P`
* А потом обратно, до `echo 'cool'` с помощью `Ctrl+N`
* Нажми `Ctrl+R` и ввести букву "i" -- выведется `echo 'is'`, так как это самая ближайшая команда, которая содержит букву "i"
* Нажми `Ctrl+R` ещё раз -- выведется `echo 'Linux'`, так как это следующая подходящая под поиск команда
* Нажми `Enter`, чтобы исполнить выделенную через поиск команду
* Если хочешь её сначала отредактировать, то нажми стрелку вправо, чтобы выйти из режима поиска

Вся история команд хранится в файле `~/.bash_history` -- терминал берёт её оттуда.

> Народная мудрость: если ты случайно написал какой-нибудь пароль прямо в командную строку, то закрой терминал (история записывается при выходе из сессии) и удали свой пароль из этого файла. Не облегчай хакерам жизнь.

# Конфигурация .bashrc

Каждый раз, когда ты запускаешь терминал, он считывает содержимое файла `~/.bashrc` -- это файл, в котором пользователь может задавать параметры для текущей сессии терминала.

Скорее всего в твоём файле `.bashrc` уже что-то есть -- многие дистрибутивы Linux сразу создают этот файл с базовым набором параметров.

Основное, что ты должен знать при работе с этим файлом, это то, что все параметры определяются через **переменные окружения**.

**Переменная окружения** -- это переменная с определённым значением, которая используется в рамках текущей сессии.

Переменная задаётся так:

```
ИМЯ_ПЕРЕМЕННОЙ=ЗНАЧЕНИЕ_ПЕРЕМЕННОЙ
```

Например, в своём `.bashrc` ты можешь задать переменную `HISTSIZE`, которая определяет максимальное количество команд, которое терминал будет помнить:

```
HISTSIZE=10000
```

Если ты добавишь в свой `.bashrc` эту строчку, то она считается при открытии новой сессии, и терминал будет "помнить" 10000 последних команд.

Существует огромное множество различных параметров, которые ты можешь настроить -- я укажу только самые полезные:

* `HISTCONTROL='ignoredups'` -- не сохранять в истории дублирующиеся команды (если одна и та же команда исполняется несколько раз)
* `PS1='\[\033[01;32m\]\W\[\033[01;32m\] \$\[\033[00m\] '` -- более компактный вид приглашения командной строки
Если что -- пиши, я помогу и постараюсь объяснить лучше.
